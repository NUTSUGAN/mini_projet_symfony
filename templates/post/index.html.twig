{% extends 'base.html.twig' %}

{% block title %}Administration - Articles{% endblock %}

{% block body %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h1 class="page-title mb-0">Articles</h1>
    <div class="text-muted small">Gérer les articles (ajout, modification, suppression)</div>
  </div>

  <a href="{{ path('app_post_new') }}" class="btn btn-primary">
    <i class="bi bi-plus-circle me-1"></i> Nouvel article
  </a>
</div>

<div class="card shadow-soft">
  <div class="card-body">

    <div class="table-responsive">
      <table class="table align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th style="width:70px;">ID</th>
            <th>Titre</th>
            <th style="width:180px;">Catégorie</th>
            <th style="width:180px;">Auteur</th>
            <th style="width:160px;">Publié le</th>
            <th style="width:160px;">Mis à jour</th>
            <th class="text-end" style="width:170px;">Actions</th>
          </tr>
        </thead>

        <tbody>
        {% for post in posts %}
          <tr>
            <td class="text-muted">#{{ post.id }}</td>

            <td>
              <div class="fw-semibold">{{ post.title }}</div>
              <div class="text-muted small">
                {{ post.content|striptags|slice(0, 90) }}{% if post.content|length > 90 %}...{% endif %}
              </div>
            </td>

            <td>
              <span class="badge text-bg-dark">{{ post.category }}</span>
            </td>

            <td class="text-muted small">
              {{ post.author ? post.author.email : '-' }}
            </td>

            <td class="text-muted small">
              {{ post.publishedAt ? post.publishedAt|date('d/m/Y H:i') : '-' }}
            </td>

            <td class="text-muted small">
              {{ post.updatedAt ? post.updatedAt|date('d/m/Y H:i') : '-' }}
            </td>

            <td class="text-end">
              <a class="btn btn-sm btn-outline-primary"
                 href="{{ path('app_post_show', {'id': post.id}) }}">
                <i class="bi bi-eye me-1"></i> Voir
              </a>

              <a class="btn btn-sm btn-outline-secondary"
                 href="{{ path('app_post_edit', {'id': post.id}) }}">
                <i class="bi bi-pencil me-1"></i> Modifier
              </a>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="7" class="text-center text-muted py-4">
              Aucun article pour le moment.
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}
